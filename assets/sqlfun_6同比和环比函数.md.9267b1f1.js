import { _ as _export_sfc, c as createElementBlock, o as openBlock, a as createStaticVNode } from "./app.222b9ad1.js";
const __pageData = JSON.parse('{"title":"\u4ECB\u7ECD","description":"","frontmatter":{},"headers":[{"level":2,"title":"compare\u51FD\u6570","slug":"compare\u51FD\u6570","link":"#compare\u51FD\u6570","children":[]},{"level":2,"title":"ts_compare\u51FD\u6570","slug":"ts-compare\u51FD\u6570","link":"#ts-compare\u51FD\u6570","children":[]}],"relativePath":"sqlfun/6\u540C\u6BD4\u548C\u73AF\u6BD4\u51FD\u6570.md"}');
const _sfc_main = { name: "sqlfun/6\u540C\u6BD4\u548C\u73AF\u6BD4\u51FD\u6570.md" };
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<h1 id="\u4ECB\u7ECD" tabindex="-1">\u4ECB\u7ECD <a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a></h1><p>\u672C\u6587\u4ECB\u7ECD\u540C\u6BD4\u548C\u73AF\u6BD4\u51FD\u6570\u7684\u57FA\u7840\u8BED\u6CD5\u548C\u793A\u4F8B\u3002</p><h1 id="\u51FD\u6570\u793A\u4F8B" tabindex="-1">\u51FD\u6570\u793A\u4F8B <a class="header-anchor" href="#\u51FD\u6570\u793A\u4F8B" aria-hidden="true">#</a></h1><p>\u65E5\u5FD7\u670D\u52A1\u652F\u6301\u5982\u4E0B\u540C\u6BD4\u548C\u73AF\u6BD4\u51FD\u6570\u3002</p><blockquote><p>\u5728\u65E5\u5FD7\u670D\u52A1\u5206\u6790\u8BED\u53E5\u4E2D\uFF0C\u8868\u793A\u5B57\u7B26\u4E32\u7684\u5B57\u7B26\u5FC5\u987B\u4F7F\u7528\u5355\u5F15\u53F7\uFF08&#39;&#39;\uFF09\u5305\u88F9\uFF0C\u65E0\u7B26\u53F7\u5305\u88F9\u6216\u88AB\u53CC\u5F15\u53F7\uFF08&quot;&quot;\uFF09\u5305\u88F9\u7684\u5B57\u7B26\u8868\u793A\u5B57\u6BB5\u540D\u6216\u5217\u540D\u3002\u4F8B\u5982\uFF1A&#39;status&#39;\u8868\u793A\u5B57\u7B26\u4E32status\uFF0Cstatus\u6216&quot;status&quot;\u8868\u793A\u65E5\u5FD7\u5B57\u6BB5status\u3002</p></blockquote><table><thead><tr><th>\u51FD\u6570\u540D\u79F0</th><th>\u8BED\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><a href="#compare%E5%87%BD%E6%95%B0">compare\u51FD\u6570</a></td><td>compare( <em>x</em> , <em>n</em> )</td><td>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</td></tr><tr><td><a href="#compare%E5%87%BD%E6%95%B0">compare\u51FD\u6570</a></td><td>compare( <em>x</em> , <em>n1</em> , <em>n2</em> , <em>n3</em> ...)</td><td>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En1\u3001n2\u3001n3\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</td></tr><tr><td><a href="#ts_compare%E5%87%BD%E6%95%B0">ts_compare\u51FD\u6570</a></td><td>ts_compare( <em>x</em> , <em>n</em> )</td><td>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002 <strong>\u6CE8\u610F</strong> ts_compare\u51FD\u6570\u5FC5\u987B\u6309\u7167\u65F6\u95F4\u5217\u8FDB\u884C\u5206\u7EC4\uFF08GROUP BY\uFF09\u3002</td></tr><tr><td><a href="#ts_compare%E5%87%BD%E6%95%B0">ts_compare\u51FD\u6570</a></td><td>ts_compare( <em>x</em> , <em>n1</em> , <em>n2</em> , <em>n3</em> ...)</td><td>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En1\u3001n2\u3001n3\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002 <strong>\u6CE8\u610F</strong> ts_compare\u51FD\u6570\u5FC5\u987B\u6309\u7167\u65F6\u95F4\u5217\u8FDB\u884C\u5206\u7EC4\uFF08GROUP BY\uFF09\u3002</td></tr></tbody></table><h1 id="\u6848\u4F8B" tabindex="-1">\u6848\u4F8B <a class="header-anchor" href="#\u6848\u4F8B" aria-hidden="true">#</a></h1><h2 id="compare\u51FD\u6570" tabindex="-1">compare\u51FD\u6570 <a class="header-anchor" href="#compare\u51FD\u6570" aria-hidden="true">#</a></h2><p>compare\u51FD\u6570\u7528\u4E8E\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</p><ul><li><p>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">compare(x, n)</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En1\u3001n2\u3001n3\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">compare(x, n1, n2, n3...)</span></span>\n<span class="line"></span></code></pre></div></li></ul><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Adouble\u7C7B\u578B\u6216long\u7C7B\u578B\u3002</td></tr><tr><td><em>n</em></td><td>\u65F6\u95F4\u7A97\u53E3\uFF0C\u5355\u4F4D\u4E3A\u79D2\u3002\u4F8B\u59823600\uFF081\u5C0F\u65F6\uFF09\u300186400\uFF081\u5929\uFF09\u3001604800\uFF081\u5468\uFF09\u300131622400\uFF081\u5E74\uFF09\u3002</td></tr></tbody></table><p>JSON\u6570\u7EC4\u3002\u683C\u5F0F\u4E3A[\u5F53\u524D\u8BA1\u7B97\u7ED3\u679C, n\u79D2\u524D\u7684\u8BA1\u7B97\u7ED3\u679C, \u5F53\u524D\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u524D\u8BA1\u7B97\u7ED3\u679C\u7684\u6BD4\u503C, n\u79D2\u524D\u7684UNIX\u65F6\u95F4\u6233]\u3002</p><ul><li><p>\u793A\u4F8B1\uFF1A\u8BA1\u7B97\u5F53\u524D1\u5C0F\u65F6\u548C\u6628\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002\u9009\u62E9\u67E5\u8BE2\u548C\u5206\u6790\u7684\u65F6\u95F4\u8303\u56F4\u4E3A <strong>1\u5C0F\u65F6\uFF08\u6574\u70B9\u65F6\u95F4\uFF09</strong> \uFF0C\u5E76\u6267\u884C\u5982\u4E0B\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5\u3002\u5176\u4E2D86400\u8868\u793A\u5F53\u524D\u65F6\u95F4\u51CF\u53BB86400\u79D2\uFF081\u5929\uFF09\uFF0Clog\u8868\u793ALogstore\u540D\u79F0\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u4E3AJSON\u6570\u7EC4\u5F62\u5F0F</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  compare(PV, </span><span style="color:#F78C6C;">86400</span><span style="color:#A6ACCD;">)</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> PV</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0280326261/p230658.png" alt="PV\u6BD4"></p><ul><li><p><strong>3337.0</strong> \u8868\u793A\u5F53\u524D1\u5C0F\u65F6\uFF08\u4F8B\u59822020-12-25 14:00:00~2020-12-25 15:00:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>3522.0</strong> \u8868\u793A\u6628\u5929\u540C\u65F6\u6BB5\uFF08\u4F8B\u59822020-12-24 14:00:00~2020-12-24 15:00:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>0.947473026689381</strong> \u8868\u793A\u5F53\u524D1\u5C0F\u65F6\u4E0E\u6628\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002</p></li></ul></li></ul></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u4E3A\u5206\u5217\u663E\u793A</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki has-diff"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [1] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> today,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [2] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> yesterday,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [3] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ratio</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      compare(PV, </span><span style="color:#F78C6C;">86400</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> diff</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      (</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> PV</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">          </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">      )</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0280326261/p231804.png" alt="\u540C\u6BD4\u7ED3\u679C"></p><ul><li><p><strong>3337.0</strong> \u8868\u793A\u5F53\u524D1\u5C0F\u65F6\uFF08\u4F8B\u59822020-12-25 14:00:00~2020-12-25 15:00:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>3522.0</strong> \u8868\u793A\u6628\u5929\u540C\u65F6\u6BB5\uFF08\u4F8B\u59822020-12-24 14:00:00~2020-12-24 15:00:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>0.947473026689381</strong> \u8868\u793A\u5F53\u524D1\u5C0F\u65F6\u4E0E\u6628\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002</p></li></ul></li></ul></li></ul></li><li><p>\u793A\u4F8B2\uFF1A\u8BA1\u7B97\u4ECA\u5929\u6BCF\u5C0F\u65F6\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u4E0E\u6628\u5929\u540C\u65F6\u6BB5\u3001\u524D\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002 \u9009\u62E9\u67E5\u8BE2\u548C\u5206\u6790\u7684\u65F6\u95F4\u8303\u56F4\u4E3A <strong>\u4ECA\u5929\uFF08\u6574\u70B9\u65F6\u95F4\uFF09</strong> \uFF0C\u5E76\u6267\u884C\u5982\u4E0B\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5\u3002\u5176\u4E2D\uFF0C86400\u8868\u793A\u5F53\u524D\u65F6\u95F4\u51CF\u53BB86400\u79D2\uFF081\u5929\uFF09\uFF0C172800\u8868\u793A\u5F53\u524D\u65F6\u95F4\u51CF\u53BB172800\u79D2\uFF082\u5929\uFF09\uFF0C log\u8868\u793ALogstore\u540D\u79F0\uFF0Cdate_format(from_unixtime(<strong>time</strong>), &#39;%H:00&#39;)\u8868\u793A\u8FD4\u56DE\u7684\u65F6\u95F4\u683C\u5F0F\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u4E3AJSON\u6570\u7EC4\u5F62\u5F0F</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki has-diff"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  compare(PV, </span><span style="color:#F78C6C;">86400</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">172800</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> diff</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> PV,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">date_format</span><span style="color:#A6ACCD;">(from_unixtime(__time__), </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%H:00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7252326261/p230798.png" alt="\u6BCF\u5206\u949FPV"></p><ul><li><p><strong>1176.0</strong> \u8868\u793A\u5F53\u524D\u65F6\u6BB5\uFF08\u4F8B\u59822020-12-25 00:00~01:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>1180</strong> \u8868\u793A\u6628\u5929\u540C\u65F6\u6BB5\uFF08\u4F8B\u59822020-12-24 00:00~01:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>1167.0</strong> \u8868\u793A\u524D\u5929\u540C\u65F6\u6BB5\uFF08\u4F8B\u59822020-12-23 00:00~01:00\uFF09\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p></li><li><p><strong>0.9966101694915255</strong> \u8868\u793A\u5F53\u524D\u65F6\u6BB5\u4E0E\u6628\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002</p></li><li><p><strong>1.0077120822622108</strong> \u8868\u793A\u5F53\u524D\u65F6\u6BB5\u4E0E\u524D\u5929\u540C\u65F6\u6BB5\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u6BD4\u503C\u3002</p></li></ul></li></ul></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u4E3A\u5206\u5217\u663E\u793A</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki has-diff"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [1] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> day1,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [2] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> day2,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [3] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> day3,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [4] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ratio1,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  diff [5] </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ratio2</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      compare(PV, </span><span style="color:#F78C6C;">86400</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">172800</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> diff</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      (</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> PV,</span></span>\n<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">date_format</span><span style="color:#A6ACCD;">(from_unixtime(__time__), </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%H:00</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">          </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">      )</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1280326261/p232220.png" alt="\u540C\u6BD4"></p></li></ul></li></ul></li><li><p>\u793A\u4F8B3\uFF1A\u73AF\u6BD412\u6708\u548C11\u6708\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002\u9009\u62E9\u67E5\u8BE2\u548C\u5206\u6790\u7684\u65F6\u95F4\u8303\u56F4\u4E3A <strong>\u672C\u6708\uFF08\u6574\u70B9\u65F6\u95F4\uFF09</strong> \uFF0C\u5E76\u6267\u884C\u5982\u4E0B\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5\u3002\u5176\u4E2D\uFF0C2592000\u8868\u793A\u5F53\u524D\u65F6\u95F4\u51CF\u53BB2592000\u79D2\uFF081\u4E2A\u6708\uFF09\uFF0C log\u8868\u793ALogstore\u540D\u79F0\uFF0Cdate_trunc(&#39;month&#39;, <strong>time</strong>)\u8868\u793A\u4F7F\u7528date_trunc\u51FD\u6570\u5C06\u65F6\u95F4\u5BF9\u9F50\u5230\u6708\u4EFD\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki has-diff"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  compare(PV, </span><span style="color:#F78C6C;">2592000</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> diff</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> PV,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      date_trunc(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">month</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, __time__) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1280326261/p232952.png" alt="\u73AF\u6BD4PV"></p></li></ul></li></ul><h2 id="ts-compare\u51FD\u6570" tabindex="-1">ts_compare\u51FD\u6570 <a class="header-anchor" href="#ts-compare\u51FD\u6570" aria-hidden="true">#</a></h2><p>ts_compare\u51FD\u6570\u7528\u4E8E\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002 <strong>\u6CE8\u610F</strong> ts_compare\u51FD\u6570\u5FC5\u987B\u6309\u7167\u65F6\u95F4\u5217\u8FDB\u884C\u5206\u7EC4\uFF08GROUP BY\uFF09\u3002</p><ul><li><p>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ts_compare(x, n)</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u5BF9\u6BD4\u5F53\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u4E0En1\u3001n2\u3001n3\u79D2\u4E4B\u524D\u65F6\u95F4\u5468\u671F\u5185\u7684\u8BA1\u7B97\u7ED3\u679C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ts_compare(x, n1, n2, n3...)</span></span>\n<span class="line"></span></code></pre></div></li></ul><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Adouble\u7C7B\u578B\u6216long\u7C7B\u578B\u3002</td></tr><tr><td><em>n</em></td><td>\u65F6\u95F4\u7A97\u53E3\uFF0C\u5355\u4F4D\u4E3A\u79D2\u3002\u4F8B\u59823600\uFF081\u5C0F\u65F6\uFF09\u300186400\uFF081\u5929\uFF09\u3001604800\uFF081\u5468\uFF09\u300131622400\uFF081\u5E74\uFF09\u3002</td></tr></tbody></table><p>JSON\u6570\u7EC4\u3002\u683C\u5F0F\u4E3A[\u5F53\u524D\u8BA1\u7B97\u7ED3\u679C, n\u79D2\u524D\u7684\u8BA1\u7B97\u7ED3\u679C, \u5F53\u524D\u8BA1\u7B97\u7ED3\u679C\u4E0En\u79D2\u524D\u8BA1\u7B97\u7ED3\u679C\u7684\u6BD4\u503C, n\u79D2\u524D\u7684UNIX\u65F6\u95F4\u6233]\u3002</p><p>\u73AF\u6BD4\u4ECA\u5929\u6BCF\u5C0F\u65F6\u7684\u7F51\u7AD9\u8BBF\u95EE\u91CF\u3002</p><p>\u9009\u62E9\u67E5\u8BE2\u548C\u5206\u6790\u7684\u65F6\u95F4\u8303\u56F4\u4E3A <strong>\u4ECA\u5929\uFF08\u76F8\u5BF9\uFF09</strong> \uFF0C\u5E76\u6267\u884C\u5982\u4E0B\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5\u3002\u5176\u4E2D3600\u8868\u793A\u5F53\u524D\u65F6\u95F4\u51CF\u53BB3600\u79D2\uFF081\u5C0F\u65F6\uFF09\uFF0C log\u8868\u793ALogstore\u540D\u79F0\uFF0Cdate_trunc(&#39;hour&#39;,<strong>time</strong> )\u8868\u793A\u4F7F\u7528date_trunc\u51FD\u6570\u5C06\u65F6\u95F4\u5BF9\u9F50\u5230\u5C0F\u65F6\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ts_compare(PV, </span><span style="color:#F78C6C;">3600</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">data</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">(</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      date_trunc(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hour</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, __time__) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> PV</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1280326261/p232314.png" alt="ts_compare"></p></li></ul>', 21);
const _hoisted_22 = [
  _hoisted_1
];
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return openBlock(), createElementBlock("div", null, _hoisted_22);
}
const _6_______ = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  _6_______ as default
};
