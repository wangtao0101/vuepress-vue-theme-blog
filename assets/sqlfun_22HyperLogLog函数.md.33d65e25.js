import { _ as _export_sfc, c as createElementBlock, o as openBlock, a as createStaticVNode } from "./app.222b9ad1.js";
const __pageData = JSON.parse('{"title":"\u4ECB\u7ECD","description":"","frontmatter":{},"headers":[{"level":2,"title":"approx_set\u51FD\u6570","slug":"approx-set\u51FD\u6570","link":"#approx-set\u51FD\u6570","children":[]},{"level":2,"title":"cardinality\u51FD\u6570","slug":"cardinality\u51FD\u6570","link":"#cardinality\u51FD\u6570","children":[]},{"level":2,"title":"empty_approx_set\u51FD\u6570","slug":"empty-approx-set\u51FD\u6570","link":"#empty-approx-set\u51FD\u6570","children":[]},{"level":2,"title":"merge\u51FD\u6570","slug":"merge\u51FD\u6570","link":"#merge\u51FD\u6570","children":[]}],"relativePath":"sqlfun/22HyperLogLog\u51FD\u6570.md"}');
const _sfc_main = { name: "sqlfun/22HyperLogLog\u51FD\u6570.md" };
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<h1 id="\u4ECB\u7ECD" tabindex="-1">\u4ECB\u7ECD <a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a></h1><p>HyperLogLog\u51FD\u6570\u4E3A\u8FD1\u4F3C\u805A\u5408\u51FD\u6570\uFF0C\u7C7B\u4F3C\u4E8Eapprox_distinct\u51FD\u6570\u3002\u5F53\u8BA1\u7B97\u7684\u6570\u636E\u91CF\u975E\u5E38\u5927\u65F6\uFF0C\u4F7F\u7528HyperLogLog\u51FD\u6570\u53EF\u5FEB\u901F\u8FD4\u56DE\u4F30\u7B97\u7ED3\u679C\u3002\u672C\u6587\u4ECB\u7ECDHyperLogLog\u51FD\u6570\u7684\u57FA\u672C\u8BED\u6CD5\u4EE5\u53CA\u793A\u4F8B\u3002</p><h1 id="\u51FD\u6570\u793A\u4F8B" tabindex="-1">\u51FD\u6570\u793A\u4F8B <a class="header-anchor" href="#\u51FD\u6570\u793A\u4F8B" aria-hidden="true">#</a></h1><p>\u65E5\u5FD7\u670D\u52A1\u652F\u6301\u5982\u4E0BHyperLogLog\u51FD\u6570\u3002</p><blockquote><p>\u5728\u65E5\u5FD7\u670D\u52A1\u5206\u6790\u8BED\u53E5\u4E2D\uFF0C\u8868\u793A\u5B57\u7B26\u4E32\u7684\u5B57\u7B26\u5FC5\u987B\u4F7F\u7528\u5355\u5F15\u53F7\uFF08&#39;&#39;\uFF09\u5305\u88F9\uFF0C\u65E0\u7B26\u53F7\u5305\u88F9\u6216\u88AB\u53CC\u5F15\u53F7\uFF08&quot;&quot;\uFF09\u5305\u88F9\u7684\u5B57\u7B26\u8868\u793A\u5B57\u6BB5\u540D\u6216\u5217\u540D\u3002\u4F8B\u5982\uFF1A&#39;status&#39;\u8868\u793A\u5B57\u7B26\u4E32status\uFF0Cstatus\u6216&quot;status&quot;\u8868\u793A\u65E5\u5FD7\u5B57\u6BB5status\u3002</p></blockquote><table><thead><tr><th>\u51FD\u6570\u540D\u79F0</th><th>\u8BED\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><a href="#approx_set%E5%87%BD%E6%95%B0">approx_set\u51FD\u6570</a></td><td>approx_set( <em>x</em> )</td><td>\u4F30\u7B97 <em>x</em> \u4E2D\u4E0D\u91CD\u590D\u503C\u7684\u4E2A\u6570\uFF0C\u6700\u5927\u6807\u51C6\u8BEF\u5DEE\u9ED8\u8BA4\u4E3A0.01625\u3002</td></tr><tr><td><a href="#cardinality%E5%87%BD%E6%95%B0">cardinality\u51FD\u6570</a></td><td>cardinality( <em>x</em> )</td><td>\u5C06HyperLogLog\u7C7B\u578B\u7684\u5185\u5BB9\u8F6C\u6362\u4E3Abigint\u7C7B\u578B\u3002</td></tr><tr><td><a href="#empty_approx_set%E5%87%BD%E6%95%B0">empty_approx_set\u51FD\u6570</a></td><td>empty_approx_set()</td><td>\u8FD4\u56DE\u4E00\u4E2AHyperLogLog\u7C7B\u578B\u7684\u7A7A\u503C\u3002\u6700\u5927\u6807\u51C6\u8BEF\u5DEE\u9ED8\u8BA4\u4E3A0.01625\u3002</td></tr><tr><td><a href="#merge%E5%87%BD%E6%95%B0">merge\u51FD\u6570</a></td><td>merge( <em>x</em> )</td><td>\u805A\u5408\u8BA1\u7B97\u6240\u6709\u7684HyperLogLog\u503C\u3002</td></tr></tbody></table><h1 id="\u6848\u4F8B" tabindex="-1">\u6848\u4F8B <a class="header-anchor" href="#\u6848\u4F8B" aria-hidden="true">#</a></h1><h2 id="approx-set\u51FD\u6570" tabindex="-1">approx_set\u51FD\u6570 <a class="header-anchor" href="#approx-set\u51FD\u6570" aria-hidden="true">#</a></h2><p>approx_set\u51FD\u6570\u7528\u4E8E\u4F30\u7B97 <em>x</em> \u4E2D\u4E0D\u91CD\u590D\u503C\u7684\u4E2A\u6570\uFF0C\u6700\u5927\u6807\u51C6\u8BEF\u5DEE\u9ED8\u8BA4\u4E3A0.01625\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">approx_set(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr></tbody></table><p>HyperLogLog\u7C7B\u578B\u3002</p><p>\u4F7F\u7528approx_set\u51FD\u6570\u4F30\u7B97\u6BCF\u5206\u949F\u7684\u7F51\u7AD9\u8BBF\u95EEUV\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3AHyperLogLog\u7F16\u7801\u683C\u5F0F\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  date_trunc(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minute</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, __time__) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  approx_set(client_ip) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  website_log</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9463711361/p325162.png" alt="approx_set"></p></li></ul><h2 id="cardinality\u51FD\u6570" tabindex="-1">cardinality\u51FD\u6570 <a class="header-anchor" href="#cardinality\u51FD\u6570" aria-hidden="true">#</a></h2><p>cardinality\u51FD\u6570\u7528\u4E8E\u5C06HyperLogLog\u7C7B\u578B\u7684\u5185\u5BB9\u8F6C\u6362\u4E3Abigint\u7C7B\u578B\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cardinality(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3AHyperLogLog\u7C7B\u578B\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\u3002</p><p>\u4F7F\u7528approx_set\u51FD\u6570\u4F30\u7B97\u6BCF\u5206\u949F\u7684\u7F51\u7AD9\u8BBF\u95EEUV\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3AHyperLogLog\u7C7B\u578B\u3002\u7136\u540E\u4F7F\u7528cardinality\u51FD\u6570\u5C06HyperLogLog\u7C7B\u578B\u8F6C\u6362\u4E3Abigint\u7C7B\u578B\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">Time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  cardinality(UV) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      date_trunc(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minute</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, __time__) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      approx_set(client_ip) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      website_log</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9463711361/p325181.png" alt="cardinality"></p></li></ul><h2 id="empty-approx-set\u51FD\u6570" tabindex="-1">empty_approx_set\u51FD\u6570 <a class="header-anchor" href="#empty-approx-set\u51FD\u6570" aria-hidden="true">#</a></h2><p>empty_approx_set\u51FD\u6570\u7528\u4E8E\u8FD4\u56DE\u4E00\u4E2AHyperLogLog\u7C7B\u578B\u7684\u7A7A\u503C\u3002\u6700\u5927\u6807\u51C6\u8BEF\u5DEE\u9ED8\u8BA4\u4E3A0.01625\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">empty_approx_set</span><span style="color:#89DDFF;">()</span></span>\n<span class="line"></span></code></pre></div><p>HyperLogLog\u7C7B\u578B\u3002</p><p>\u8FD4\u56DE\u4E00\u4E2AHyperLogLog\u7C7B\u578B\u7684\u7A7A\u503C\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;">  empty_approx_set</span><span style="color:#89DDFF;">()</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9463711361/p325211.png" alt="empty_approx_set"></p></li></ul><h2 id="merge\u51FD\u6570" tabindex="-1">merge\u51FD\u6570 <a class="header-anchor" href="#merge\u51FD\u6570" aria-hidden="true">#</a></h2><p>merge\u51FD\u6570\u7528\u4E8E\u805A\u5408\u8BA1\u7B97\u6240\u6709\u7684HyperLogLog\u503C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">merge</span><span style="color:#A6ACCD;">(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3AHyperLogLog\u7C7B\u578B\u3002</td></tr></tbody></table><p>HyperLogLog\u7C7B\u578B\u3002</p><p>\u4F7F\u7528approx_set\u51FD\u6570\u4F30\u7B97\u6BCF\u5206\u949F\u7684\u7F51\u7AD9\u8BBF\u95EEUV\uFF0C\u4F7F\u7528merge\u51FD\u6570\u805A\u5408\u8BA1\u7B9715\u5206\u949F\u5185\u6240\u6709\u7684UV\uFF0C\u7136\u540E\u4F7F\u7528cardinality\u51FD\u6570\u5C06HyperLogLog\u7C7B\u578B\u8F6C\u6362\u4E3Abigint\u7C7B\u578B\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">Time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  cardinality(UV) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  cardinality(</span><span style="color:#F78C6C;">merge</span><span style="color:#A6ACCD;">(UV) </span><span style="color:#F78C6C;">over</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> Total_UV</span></span>\n<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">  (</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">      date_trunc(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minute</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, __time__) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Time</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">      approx_set(client_ip) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> UV</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">log</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">Time</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9463711361/p325227.png" alt="merge"></p></li></ul>', 34);
const _hoisted_35 = [
  _hoisted_1
];
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return openBlock(), createElementBlock("div", null, _hoisted_35);
}
const _22HyperLogLog__ = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  _22HyperLogLog__ as default
};
