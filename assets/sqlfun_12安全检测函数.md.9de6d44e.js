import { _ as _export_sfc, c as createElementBlock, o as openBlock, a as createStaticVNode } from "./app.222b9ad1.js";
const __pageData = JSON.parse('{"title":"\u4ECB\u7ECD","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5E94\u7528\u573A\u666F","slug":"\u5E94\u7528\u573A\u666F","link":"#\u5E94\u7528\u573A\u666F","children":[]},{"level":2,"title":"\u529F\u80FD\u7279\u70B9","slug":"\u529F\u80FD\u7279\u70B9","link":"#\u529F\u80FD\u7279\u70B9","children":[]},{"level":2,"title":"\u51FD\u6570\u5217\u8868","slug":"\u51FD\u6570\u5217\u8868","link":"#\u51FD\u6570\u5217\u8868","children":[]},{"level":2,"title":"security_check_ip\u51FD\u6570","slug":"security-check-ip\u51FD\u6570","link":"#security-check-ip\u51FD\u6570","children":[]},{"level":2,"title":"security_check_domain\u51FD\u6570","slug":"security-check-domain\u51FD\u6570","link":"#security-check-domain\u51FD\u6570","children":[]},{"level":2,"title":"security_check_url\u51FD\u6570","slug":"security-check-url\u51FD\u6570","link":"#security-check-url\u51FD\u6570","children":[]}],"relativePath":"sqlfun/12\u5B89\u5168\u68C0\u6D4B\u51FD\u6570.md"}');
const _sfc_main = { name: "sqlfun/12\u5B89\u5168\u68C0\u6D4B\u51FD\u6570.md" };
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<h1 id="\u4ECB\u7ECD" tabindex="-1">\u4ECB\u7ECD <a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a></h1><p>\u65E5\u5FD7\u670D\u52A1\u4F9D\u6258\u5168\u7403\u767D\u5E3D\u5B50\u5171\u4EAB\u5B89\u5168\u8D44\u4EA7\u5E93\uFF0C\u63D0\u4F9B\u5B89\u5168\u68C0\u6D4B\u51FD\u6570\u3002\u60A8\u53EA\u9700\u901A\u8FC7\u65E5\u5FD7\u4E2D\u7684IP\u5730\u5740\u3001\u57DF\u540D\u6216\u8005URL\uFF0C\u5373\u53EF\u68C0\u6D4B\u5176\u662F\u5426\u5B89\u5168\u3002\u672C\u6587\u4ECB\u7ECD\u5B89\u5168\u68C0\u6D4B\u51FD\u6570\u7684\u57FA\u672C\u8BED\u6CD5\u53CA\u793A\u4F8B\u3002</p><h2 id="\u5E94\u7528\u573A\u666F" tabindex="-1">\u5E94\u7528\u573A\u666F <a class="header-anchor" href="#\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a></h2><p>\u5B89\u5168\u68C0\u6D4B\u51FD\u6570\u9002\u7528\u5982\u4E0B\u573A\u666F\uFF1A</p><ul><li><p>\u9488\u5BF9\u670D\u52A1\u8FD0\u7EF4\u6709\u8F83\u5F3A\u9700\u6C42\u7684\u4F01\u4E1A\u548C\u673A\u6784\uFF08\u4F8B\u5982\u4E92\u8054\u7F51\u3001\u6E38\u620F\u3001\u54A8\u8BE2\u7B49\uFF09\uFF0C\u5176IT\u4EBA\u5458\u548C\u5B89\u5168\u8FD0\u7EF4\u4EBA\u5458\u53EF\u53CA\u65F6\u53D1\u73B0\u53EF\u7591\u8BBF\u95EE\u3001\u653B\u51FB\u53CA\u4FB5\u5165\u7F51\u7AD9\u7B49\u884C\u4E3A\uFF0C\u5E76\u53CA\u65F6\u91C7\u53D6\u63AA\u65BD\u3002</p></li><li><p>\u9488\u5BF9\u5185\u90E8\u8D44\u4EA7\u4FDD\u62A4\u6709\u8F83\u5F3A\u9700\u6C42\u7684\u4F01\u4E1A\u548C\u673A\u6784\uFF08\u4F8B\u5982\u94F6\u884C\u3001\u8BC1\u5238\u3001\u7535\u5546\u7B49\uFF09\uFF0C\u5176IT\u4EBA\u5458\u548C\u5B89\u5168\u8FD0\u7EF4\u4EBA\u5458\u53EF\u53CA\u65F6\u53D1\u73B0\u5185\u90E8\u8BBF\u95EE\u5371\u9669\u7F51\u7AD9\u53CA\u4E0B\u8F7D\u6728\u9A6C\u7B49\u884C\u4E3A\uFF0C\u5E76\u53CA\u65F6\u91C7\u53D6\u884C\u52A8\u3002</p></li></ul><h2 id="\u529F\u80FD\u7279\u70B9" tabindex="-1">\u529F\u80FD\u7279\u70B9 <a class="header-anchor" href="#\u529F\u80FD\u7279\u70B9" aria-hidden="true">#</a></h2><p>\u5B89\u5168\u68C0\u6D4B\u51FD\u6570\u5177\u5907\u5982\u4E0B\u529F\u80FD\u7279\u70B9\uFF1A</p><ul><li><p>\u53EF\u9760\uFF1A\u4F9D\u6258\u5168\u7403\u5171\u4EAB\u7684\u767D\u5E3D\u5B50\u5B89\u5168\u8D44\u4EA7\u5E93\uFF0C\u5E76\u53CA\u65F6\u66F4\u65B0\u3002</p></li><li><p>\u5FEB\u901F\uFF1A\u68C0\u6D4B\u767E\u4E07IP\u5730\u5740\u3001\u57DF\u540D\u6216URL\u4EC5\u9700\u51E0\u79D2\u949F\u3002</p></li><li><p>\u7B80\u5355\uFF1A\u652F\u6301\u4EFB\u4F55\u7F51\u7EDC\u65E5\u5FD7\uFF0C\u8C03\u75283\u4E2ASQL\u51FD\u6570security_check_ip\u3001security_check_domain\u3001security_check_url\u5373\u53EF\u83B7\u5F97\u7ED3\u679C\u3002</p></li><li><p>\u7075\u6D3B\uFF1A\u4EA4\u4E92\u5F0F\u67E5\u8BE2\u53CA\u53EF\u89C6\u5316\u5C55\u793A\uFF0C\u652F\u6301\u521B\u5EFA\u544A\u8B66\u3002</p></li></ul><h2 id="\u51FD\u6570\u5217\u8868" tabindex="-1">\u51FD\u6570\u5217\u8868 <a class="header-anchor" href="#\u51FD\u6570\u5217\u8868" aria-hidden="true">#</a></h2><p>\u65E5\u5FD7\u670D\u52A1\u652F\u6301\u5982\u4E0B\u5B89\u5168\u68C0\u67E5\u51FD\u6570\u3002 <strong>\u6CE8\u610F</strong> \u5728\u65E5\u5FD7\u670D\u52A1\u5206\u6790\u8BED\u53E5\u4E2D\uFF0C\u8868\u793A\u5B57\u7B26\u4E32\u7684\u5B57\u7B26\u5FC5\u987B\u4F7F\u7528\u5355\u5F15\u53F7\uFF08&#39;&#39;\uFF09\u5305\u88F9\uFF0C\u65E0\u7B26\u53F7\u5305\u88F9\u6216\u88AB\u53CC\u5F15\u53F7\uFF08&quot;&quot;\uFF09\u5305\u88F9\u7684\u5B57\u7B26\u8868\u793A\u5B57\u6BB5\u540D\u6216\u5217\u540D\u3002\u4F8B\u5982\uFF1A&#39;status&#39;\u8868\u793A\u5B57\u7B26\u4E32status\uFF0Cstatus\u6216&quot;status&quot;\u8868\u793A\u65E5\u5FD7\u5B57\u6BB5status\u3002</p><table><thead><tr><th>\u51FD\u6570\u540D\u79F0</th><th>\u8BED\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><a href="#security_check_ip%E5%87%BD%E6%95%B0">security_check_ip\u51FD\u6570</a></td><td>security_check_ip( <em>x</em> )</td><td>\u68C0\u67E5IP\u5730\u5740\u662F\u5426\u5B89\u5168\u3002</td></tr><tr><td><a href="#security_check_domain%E5%87%BD%E6%95%B0">security_check_domain\u51FD\u6570</a></td><td>security_check_domain( <em>x</em> )</td><td>\u68C0\u67E5\u57DF\u540D\u662F\u5426\u5B89\u5168\u3002</td></tr><tr><td><a href="#security_check_url%E5%87%BD%E6%95%B0">security_check_url\u51FD\u6570</a></td><td>security_check_url( <em>x</em> )</td><td>\u68C0\u67E5URL\u662F\u5426\u5B89\u5168\u3002</td></tr></tbody></table><h1 id="\u6848\u4F8B" tabindex="-1">\u6848\u4F8B <a class="header-anchor" href="#\u6848\u4F8B" aria-hidden="true">#</a></h1><h2 id="security-check-ip\u51FD\u6570" tabindex="-1">security_check_ip\u51FD\u6570 <a class="header-anchor" href="#security-check-ip\u51FD\u6570" aria-hidden="true">#</a></h2><p>security_check_ip\u51FD\u6570\u7528\u4E8E\u68C0\u67E5IP\u5730\u5740\u662F\u5426\u5B89\u5168\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">security_check_ip(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3AIP\u5730\u5740\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\uFF0C\u53D6\u503C\u8BF4\u660E\uFF1A</p><ul><li><p>1\uFF1A\u4E0D\u5B89\u5168\u3002</p></li><li><p>0\uFF1A\u5B89\u5168\u3002</p></li></ul><p>\u901A\u8FC7client_ip\u5B57\u6BB5\u7EDF\u8BA1\u7F51\u7AD9\u7684\u4E0D\u5B89\u5168\u5BA2\u6237\u7AEF\u4FE1\u606F\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  client_ip,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ip_to_country(client_ip,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">en</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> country,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ip_to_provider(client_ip) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">provider</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> PV</span></span>\n<span class="line"><span style="color:#F78C6C;">WHERE</span></span>\n<span class="line"><span style="color:#A6ACCD;">  security_check_ip(client_ip) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  client_ip</span></span>\n<span class="line"><span style="color:#F78C6C;">ORDER BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  PV </span><span style="color:#F78C6C;">DESC</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5649246261/p8690.png" alt="\u5730\u56FE"></p></li></ul><h2 id="security-check-domain\u51FD\u6570" tabindex="-1">security_check_domain\u51FD\u6570 <a class="header-anchor" href="#security-check-domain\u51FD\u6570" aria-hidden="true">#</a></h2><p>security_check_domain\u51FD\u6570\u7528\u4E8E\u68C0\u67E5\u57DF\u540D\u662F\u5426\u5B89\u5168\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">security_check_domain(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u57DF\u540D\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\uFF0C\u53D6\u503C\u8BF4\u660E\uFF1A</p><ul><li><p>1\uFF1A\u4E0D\u5B89\u5168\u3002</p></li><li><p>0\uFF1A\u5B89\u5168\u3002</p></li></ul><p>\u901A\u8FC7\u7F51\u7AD9\u57DF\u540D\u7EDF\u8BA1\u7F51\u7AD9\u6BCF\u5206\u949F\u51FA\u73B0\u4E0D\u5B89\u5168\u8BBF\u95EE\u7684\u6B21\u6570\uFF0C\u5E76\u901A\u8FC7\u6298\u7EBF\u56FE\u5C55\u793A\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;"> : </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  count_if(</span></span>\n<span class="line"><span style="color:#A6ACCD;">    security_check_domain (http_referer) </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u95EE\u9898\u603B\u6570</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  time_series(__time__, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1m</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%H:%i:%s</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2014961361/p295468.png" alt="security_check_domain"></p></li></ul><h2 id="security-check-url\u51FD\u6570" tabindex="-1">security_check_url\u51FD\u6570 <a class="header-anchor" href="#security-check-url\u51FD\u6570" aria-hidden="true">#</a></h2><p>security_check_url\u51FD\u6570\u7528\u4E8E\u68C0\u67E5URL\u5730\u5740\u662F\u5426\u5B89\u5168\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">security_check_url(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3AURL\u5730\u5740\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\uFF0C\u53D6\u503C\u8BF4\u660E\uFF1A</p><ul><li><p>1\uFF1A\u4E0D\u5B89\u5168\u3002</p></li><li><p>0\uFF1A\u5B89\u5168\u3002</p></li></ul><p>\u901A\u8FC7URL\u5730\u5740\u7EDF\u8BA1\u7F51\u7AD9\u6BCF\u5206\u949F\u5B89\u5168\u8BBF\u95EE\u7684\u6B21\u6570\uFF0C\u5E76\u901A\u8FC7\u6298\u7EBF\u56FE\u5C55\u793A\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;"> : </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  count_if(</span></span>\n<span class="line"><span style="color:#A6ACCD;">    security_check_url (request_uri) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5B89\u5168\u603B\u6570</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  time_series(__time__, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1m</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%H:%i</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#F78C6C;">GROUP BY</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">time</span></span>\n<span class="line"><span style="color:#F78C6C;">LIMIT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">20</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0237611361/p325037.png" alt="security_check_url"></p></li></ul>', 36);
const _hoisted_37 = [
  _hoisted_1
];
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return openBlock(), createElementBlock("div", null, _hoisted_37);
}
const _12______ = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  _12______ as default
};
