import { _ as _export_sfc, c as createElementBlock, o as openBlock, a as createStaticVNode } from "./app.222b9ad1.js";
const __pageData = JSON.parse('{"title":"\u4ECB\u7ECD","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u4E0B\u6807\u8FD0\u7B97\u7B26","slug":"\u4E0B\u6807\u8FD0\u7B97\u7B26","link":"#\u4E0B\u6807\u8FD0\u7B97\u7B26","children":[]},{"level":2,"title":"cardinality\u51FD\u6570","slug":"cardinality\u51FD\u6570","link":"#cardinality\u51FD\u6570","children":[]},{"level":2,"title":"element_at\u51FD\u6570","slug":"element-at\u51FD\u6570","link":"#element-at\u51FD\u6570","children":[]},{"level":2,"title":"histogram\u51FD\u6570","slug":"histogram\u51FD\u6570","link":"#histogram\u51FD\u6570","children":[]},{"level":2,"title":"histogram_u\u51FD\u6570","slug":"histogram-u\u51FD\u6570","link":"#histogram-u\u51FD\u6570","children":[]},{"level":2,"title":"map\u51FD\u6570","slug":"map\u51FD\u6570","link":"#map\u51FD\u6570","children":[]},{"level":2,"title":"map_agg\u51FD\u6570","slug":"map-agg\u51FD\u6570","link":"#map-agg\u51FD\u6570","children":[]},{"level":2,"title":"map_concat\u51FD\u6570","slug":"map-concat\u51FD\u6570","link":"#map-concat\u51FD\u6570","children":[]},{"level":2,"title":"map_filter\u51FD\u6570","slug":"map-filter\u51FD\u6570","link":"#map-filter\u51FD\u6570","children":[]},{"level":2,"title":"map_keys\u51FD\u6570","slug":"map-keys\u51FD\u6570","link":"#map-keys\u51FD\u6570","children":[]},{"level":2,"title":"map_values\u51FD\u6570","slug":"map-values\u51FD\u6570","link":"#map-values\u51FD\u6570","children":[]},{"level":2,"title":"multimap_agg\u51FD\u6570","slug":"multimap-agg\u51FD\u6570","link":"#multimap-agg\u51FD\u6570","children":[]}],"relativePath":"sqlfun/8Map\u6620\u5C04\u51FD\u6570\u548C\u8FD0\u7B97\u7B26.md"}');
const _sfc_main = { name: "sqlfun/8Map\u6620\u5C04\u51FD\u6570\u548C\u8FD0\u7B97\u7B26.md" };
const _hoisted_1 = /* @__PURE__ */ createStaticVNode('<h1 id="\u4ECB\u7ECD" tabindex="-1">\u4ECB\u7ECD <a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a></h1><p>\u672C\u6587\u4ECB\u7ECDMap\u6620\u5C04\u51FD\u6570\u548C\u8FD0\u7B97\u7B26\u7684\u57FA\u672C\u8BED\u6CD5\u53CA\u793A\u4F8B\u3002</p><h1 id="\u51FD\u6570\u793A\u4F8B" tabindex="-1">\u51FD\u6570\u793A\u4F8B <a class="header-anchor" href="#\u51FD\u6570\u793A\u4F8B" aria-hidden="true">#</a></h1><p>\u65E5\u5FD7\u670D\u52A1\u652F\u6301\u5982\u4E0BMap\u6620\u5C04\u51FD\u6570\u548C\u8FD0\u7B97\u7B26\u3002</p><blockquote><p>\u5728\u65E5\u5FD7\u670D\u52A1\u5206\u6790\u8BED\u53E5\u4E2D\uFF0C\u8868\u793A\u5B57\u7B26\u4E32\u7684\u5B57\u7B26\u5FC5\u987B\u4F7F\u7528\u5355\u5F15\u53F7\uFF08&#39;&#39;\uFF09\u5305\u88F9\uFF0C\u65E0\u7B26\u53F7\u5305\u88F9\u6216\u88AB\u53CC\u5F15\u53F7\uFF08&quot;&quot;\uFF09\u5305\u88F9\u7684\u5B57\u7B26\u8868\u793A\u5B57\u6BB5\u540D\u6216\u5217\u540D\u3002\u4F8B\u5982\uFF1A&#39;status&#39;\u8868\u793A\u5B57\u7B26\u4E32status\uFF0Cstatus\u6216&quot;status&quot;\u8868\u793A\u65E5\u5FD7\u5B57\u6BB5status\u3002</p></blockquote><table><thead><tr><th>\u51FD\u6570\u540D\u79F0</th><th>\u8BED\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><a href="#%E4%B8%8B%E6%A0%87%E8%BF%90%E7%AE%97%E7%AC%A6">\u4E0B\u6807\u8FD0\u7B97\u7B26</a></td><td>[ <em>x</em> ]</td><td>\u83B7\u53D6Map\u4E2D\u76EE\u6807\u952E\u7684\u503C\u3002</td></tr><tr><td><a href="#cardinality%E5%87%BD%E6%95%B0">cardinality\u51FD\u6570</a></td><td>cardinality( <em>x</em> )</td><td>\u8BA1\u7B97Map\u7684\u5927\u5C0F\u3002</td></tr><tr><td><a href="#element_at%E5%87%BD%E6%95%B0">element_at\u51FD\u6570</a></td><td>element_at( <em>x</em> , <em>key</em> )</td><td>\u83B7\u53D6Map\u4E2D\u76EE\u6807\u952E\u7684\u503C\u3002</td></tr><tr><td><a href="#histogram%E5%87%BD%E6%95%B0">histogram\u51FD\u6570</a></td><td>histogram( <em>x</em> )</td><td>\u5BF9\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u8FDB\u884C\u5206\u7EC4\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3AJSON\u683C\u5F0F\u3002</td></tr><tr><td><a href="#histogram_u%E5%87%BD%E6%95%B0">histogram_u\u51FD\u6570</a></td><td>histogram_u( <em>x</em> )</td><td>\u5BF9\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u8FDB\u884C\u5206\u7EC4\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3A\u591A\u884C\u591A\u5217\u683C\u5F0F\u3002</td></tr><tr><td><a href="#map%E5%87%BD%E6%95%B0">map\u51FD\u6570</a></td><td>map()</td><td>\u8FD4\u56DE\u4E00\u4E2A\u7A7AMap\u3002</td></tr><tr><td><a href="#map%E5%87%BD%E6%95%B0">map\u51FD\u6570</a></td><td>map( <em>x</em> , <em>y</em> )</td><td>\u5C06\u4E24\u4E2A\u6570\u7EC4\u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002</td></tr><tr><td><a href="#map_agg%E5%87%BD%E6%95%B0">map_agg\u51FD\u6570</a></td><td>map_agg( <em>x</em> , <em>y</em> )</td><td>\u5C06 <em>x</em> \u548C <em>y</em> \u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002 <em>x</em> \u4E3AMap\u4E2D\u7684\u952E\uFF0C <em>y</em> \u4E3AMap\u4E2D\u7684\u952E\u503C\u3002\u5F53 <em>y</em> \u5B58\u5728\u591A\u4E2A\u503C\u65F6\uFF0C\u968F\u673A\u63D0\u53D6\u4E00\u4E2A\u503C\u4F5C\u4E3A\u952E\u503C\u3002</td></tr><tr><td><a href="#map_concat%E5%87%BD%E6%95%B0">map_concat\u51FD\u6570</a></td><td>map_concat( <em>x</em> , <em>y</em> ...)</td><td>\u5C06\u591A\u4E2AMap\u5408\u5E76\u4E3A\u4E00\u4E2AMap\u3002</td></tr><tr><td><a href="#map_filter%E5%87%BD%E6%95%B0">map_filter\u51FD\u6570</a></td><td>map_filter( <em>x</em> , <em>lambda_expression</em> )</td><td>\u7ED3\u5408Lambda\u8868\u8FBE\u5F0F\uFF0C\u7528\u4E8E\u8FC7\u6EE4Map\u4E2D\u7684\u5143\u7D20\u3002</td></tr><tr><td><a href="#map_keys%E5%87%BD%E6%95%B0">map_keys\u51FD\u6570</a></td><td>map_keys( <em>x</em> )</td><td>\u63D0\u53D6Map\u4E2D\u6240\u6709\u7684\u952E\uFF0C\u5E76\u4EE5\u6570\u7EC4\u5F62\u5F0F\u8FD4\u56DE\u3002</td></tr><tr><td><a href="#map_values%E5%87%BD%E6%95%B0">map_values\u51FD\u6570</a></td><td>map_values( <em>x</em> )</td><td>\u63D0\u53D6Map\u4E2D\u6240\u6709\u952E\u7684\u503C\uFF0C\u5E76\u4EE5\u6570\u7EC4\u5F62\u5F0F\u8FD4\u56DE\u3002</td></tr><tr><td><a href="#multimap_agg%E5%87%BD%E6%95%B0">multimap_agg\u51FD\u6570</a></td><td>multimap_agg( <em>x</em> , <em>y</em> )</td><td>\u5C06 <em>x</em> \u548C <em>y</em> \u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002 <em>x</em> \u4E3AMap\u4E2D\u7684\u952E\uFF0C <em>y</em> \u4E3AMap\u4E2D\u7684\u952E\u503C\uFF0C\u952E\u503C\u4E3A\u6570\u7EC4\u683C\u5F0F\u3002\u5F53 <em>y</em> \u5B58\u5728\u591A\u4E2A\u503C\u65F6\uFF0C\u63D0\u53D6\u6240\u6709\u7684\u503C\u4F5C\u4E3A\u952E\u503C\u3002</td></tr></tbody></table><h1 id="\u6848\u4F8B" tabindex="-1">\u6848\u4F8B <a class="header-anchor" href="#\u6848\u4F8B" aria-hidden="true">#</a></h1><h2 id="\u4E0B\u6807\u8FD0\u7B97\u7B26" tabindex="-1">\u4E0B\u6807\u8FD0\u7B97\u7B26 <a class="header-anchor" href="#\u4E0B\u6807\u8FD0\u7B97\u7B26" aria-hidden="true">#</a></h2><p>\u4E0B\u6807\u8FD0\u7B97\u7B26\u7528\u4E8E\u83B7\u53D6Map\u4E2D\u7684\u76EE\u6807\u952E\u7684\u503C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">[x]</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Avarchar\u7C7B\u578B\u3002</td></tr></tbody></table><p>\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</p><p>\u65E5\u5FD7\u670D\u52A1\u6570\u636E\u52A0\u5DE5\u65E5\u5FD7\u4E2Detl_context\u5B57\u6BB5\u503C\u4E3Amap\u7C7B\u578B\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528\u4E0B\u6807\u8FD0\u7B97\u7B26\u83B7\u53D6etl_context\u5B57\u6BB5\u503C\u4E2Dproject\u7684\u503C\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">etl_context: {</span></span>\n<span class="line"><span style="color:#A6ACCD;">project:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">datalab-148****6461-cn-chengdu</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">logstore:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal-etl-log</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer_group:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-83****4d1965</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-b2d40ed****c8d6-291294</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">shard_id:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> }</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">try_cast</span><span style="color:#A6ACCD;">(json_parse(etl_context) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> map(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">))[&#39;project&#39;]</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0652678261/p303793.png" alt="\u4E0B\u6807\u8FD0\u7B97\u7B26"></p></li></ul><h2 id="cardinality\u51FD\u6570" tabindex="-1">cardinality\u51FD\u6570 <a class="header-anchor" href="#cardinality\u51FD\u6570" aria-hidden="true">#</a></h2><p>cardinality\u51FD\u6570\u7528\u4E8E\u8BA1\u7B97Map\u7684\u5927\u5C0F\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cardinality(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\u3002</p><p>\u4F7F\u7528histogram\u51FD\u6570\u83B7\u53D6\u5404\u4E2A\u8BF7\u6C42\u65B9\u6CD5\u5BF9\u5E94\u7684\u8BF7\u6C42\u6570\u91CF\uFF0C\u518D\u901A\u8FC7cardinality\u51FD\u6570\u83B7\u53D6\u8BF7\u6C42\u65B9\u6CD5\u7684\u79CD\u7C7B\u6570\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(request_method) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> request_method,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  cardinality(</span><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(request_method)) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">kinds</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0652678261/p296534.png" alt="cardinality"></p></li></ul><h2 id="element-at\u51FD\u6570" tabindex="-1">element_at\u51FD\u6570 <a class="header-anchor" href="#element-at\u51FD\u6570" aria-hidden="true">#</a></h2><p>element_at\u51FD\u6570\u7528\u4E8E\u83B7\u53D6Map\u4E2D\u76EE\u6807\u952E\u7684\u503C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">element_at(x, </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr><tr><td><em>key</em></td><td>Map\u4E2D\u7684\u4E00\u4E2A\u952E\u3002</td></tr></tbody></table><p>\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</p><p>\u4F7F\u7528histogram\u51FD\u6570\u83B7\u53D6\u5404\u4E2A\u8BF7\u6C42\u65B9\u6CD5\u5BF9\u5E94\u7684\u8BF7\u6C42\u6570\u91CF\uFF0C\u7136\u540E\u901A\u8FC7element_at\u51FD\u6570\u83B7\u53D6DELETE\u5B57\u6BB5\u7684\u503C\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(request_method) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> request_method,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  element_at(</span><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(request_method),</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">DELETE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">count</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1652678261/p303259.png" alt="element_at"></p></li></ul><h2 id="histogram\u51FD\u6570" tabindex="-1">histogram\u51FD\u6570 <a class="header-anchor" href="#histogram\u51FD\u6570" aria-hidden="true">#</a></h2><p>histogram\u51FD\u6570\u7528\u4E8E\u5BF9\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u8FDB\u884C\u5206\u7EC4\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3AJSON\u683C\u5F0F\u3002\u7C7B\u4F3C\u4E8E<code>* | SELECT count(*) GROUP BY </code> <em>x</em> \u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><p>\u4F7F\u7528histogram\u51FD\u6570\u83B7\u53D6\u5404\u4E2A\u8BF7\u6C42\u65B9\u6CD5\u5BF9\u5E94\u7684\u8BF7\u6C42\u6570\u91CF\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">histogram</span><span style="color:#A6ACCD;">(request_method) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> request_method</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9832296261/p242188.png" alt="histogram"></p></li></ul><h2 id="histogram-u\u51FD\u6570" tabindex="-1">histogram_u\u51FD\u6570 <a class="header-anchor" href="#histogram-u\u51FD\u6570" aria-hidden="true">#</a></h2><p>histogram_u\u51FD\u6570\u7528\u4E8E\u5BF9\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u8FDB\u884C\u5206\u7EC4\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E3A\u591A\u884C\u591A\u5217\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">histogram_u(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr></tbody></table><p>bigint\u7C7B\u578B\u3002</p><p>\u4F7F\u7528histogram_u\u51FD\u6570\u83B7\u53D6\u5404\u4E2A\u8BF7\u6C42\u65B9\u6CD5\u5BF9\u5E94\u7684\u8BF7\u6C42\u6570\u91CF\uFF0C\u5E76\u4EE5\u67F1\u5F62\u56FE\u5C55\u793A\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">|</span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;">  histogram_u(request_method) </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> request_method</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9832296261/p242220.png" alt="histogram_u"></p></li></ul><h2 id="map\u51FD\u6570" tabindex="-1">map\u51FD\u6570 <a class="header-anchor" href="#map\u51FD\u6570" aria-hidden="true">#</a></h2><p>map\u51FD\u6570\u7528\u4E8E\u8FD4\u56DE\u4E00\u4E2A\u7A7AMap\u6216\u8005\u5C06\u4E24\u4E2A\u6570\u7EC4\u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002</p><ul><li><p>\u8FD4\u56DE\u4E00\u4E2A\u7A7AMap\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">()</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u5C06\u4E24\u4E2A\u6570\u7EC4\u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map(x,y) </span></span>\n<span class="line"></span></code></pre></div></li></ul><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Aarray\u7C7B\u578B\u3002</td></tr><tr><td><em>y</em></td><td>\u53C2\u6570\u503C\u4E3Aarray\u7C7B\u578B\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><ul><li><p>\u793A\u4F8B1\uFF1Aclass\u5B57\u6BB5\u8868\u793A\u73ED\u7EA7\uFF0Cnumber\u5B57\u6BB5\u8868\u793A\u73ED\u7EA7\u4EBA\u6570\uFF0C\u5B57\u6BB5\u503C\u4E3Aarray\u7C7B\u578B\u3002\u73B0\u4F7F\u7528map\u51FD\u6570\u5C06\u4E24\u4E2A\u5B57\u6BB5\u7684\u503C\uFF08\u4E24\u4E2A\u6570\u7EC4\uFF09\u6620\u5C04\u4E3A\u4E00\u4E2AMap\uFF0C\u5C06\u73ED\u7EA7\u548C\u73ED\u7EA7\u4EBA\u6570\u4E00\u4E00\u5BF9\u5E94\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">class:[&quot;class01&quot;,&quot;class02&quot;,&quot;class03&quot;,&quot;class04&quot;,&quot;class05&quot;]</span></span>\n<span class="line"><span style="color:#C792EA;">number</span><span style="color:#A6ACCD;">:[49,50,45,47,50]</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map(</span><span style="color:#82AAFF;">try_cast</span><span style="color:#A6ACCD;">(json_parse(class) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> array(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">)) ,</span><span style="color:#82AAFF;">try_cast</span><span style="color:#A6ACCD;">(json_parse(</span><span style="color:#C792EA;">number</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> array(</span><span style="color:#F78C6C;">bigint</span><span style="color:#A6ACCD;">)))</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1652678261/p303301.png" alt="map"></p></li></ul></li><li><p>\u793A\u4F8B2\uFF1A\u8FD4\u56DE\u4E00\u4E2A\u7A7AMap\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">| </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map</span><span style="color:#89DDFF;">()</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1652678261/p303267.png" alt="map"></p></li></ul></li></ul><h2 id="map-agg\u51FD\u6570" tabindex="-1">map_agg\u51FD\u6570 <a class="header-anchor" href="#map-agg\u51FD\u6570" aria-hidden="true">#</a></h2><p>map_agg\u51FD\u6570\u7528\u4E8E\u5C06 <em>x</em> \u548C <em>y</em> \u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002 <em>x</em> \u4E3AMap\u4E2D\u7684\u952E\uFF0C <em>y</em> \u4E3AMap\u4E2D\u7684\u952E\u503C\u3002\u5F53 <em>y</em> \u5B58\u5728\u591A\u4E2A\u503C\u65F6\uFF0C\u968F\u673A\u63D0\u53D6\u4E00\u4E2A\u503C\u4F5C\u4E3A\u952E\u503C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map_agg(x, y)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr><tr><td><em>y</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><p>\u63D0\u53D6request_method\u5B57\u6BB5\u503C\u548Crequest_time\u5B57\u6BB5\u503C\uFF0C\u7136\u540E\u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002request_method\u5B57\u6BB5\u503C\u4E3AMap\u4E2D\u7684\u952E\uFF0Crequest_time\u5B57\u6BB5\u503C\u4E3AMap\u4E2D\u7684\u952E\u503C\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">request_method:POST</span></span>\n<span class="line"><span style="color:#A6ACCD;">request_time:</span><span style="color:#F78C6C;">80</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map_agg(request_method,request_time)</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4951288261/p242224.png" alt="map_agg"></p></li></ul><h2 id="map-concat\u51FD\u6570" tabindex="-1">map_concat\u51FD\u6570 <a class="header-anchor" href="#map-concat\u51FD\u6570" aria-hidden="true">#</a></h2><p>map_concat\u51FD\u6570\u7528\u4E8E\u5C06\u591A\u4E2AMap\u5408\u5E76\u4E3A\u4E00\u4E2AMap\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map_concat(x, y)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr><tr><td><em>y</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><p>\u65E5\u5FD7\u670D\u52A1\u6570\u636E\u52A0\u5DE5\u65E5\u5FD7\u4E2Detl_context\u5B57\u6BB5\u503C\u548Cprogress\u5B57\u6BB5\u503C\u90FD\u4E3Amap\u7C7B\u578B\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528map_concat\u51FD\u6570\u5C06\u8FD9\u4E24\u4E2A\u5B57\u6BB5\u503C\u5408\u5E76\u4E3A\u4E00\u4E2AMap\u3002</p><ul><li><p>\u5B57\u6BB5\u793A\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">etl_context: {</span></span>\n<span class="line"><span style="color:#A6ACCD;"> project:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">datalab-148****6461-cn-chengdu</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;"> logstore:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal-etl-log</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;"> consumer_group:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-83****4d1965</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;"> consumer:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-b2d40ed****c8d6-291294</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;"> shard_id:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> }</span></span>\n<span class="line"><span style="color:#A6ACCD;">progress: {</span></span>\n<span class="line"><span style="color:#A6ACCD;"> accept:</span><span style="color:#F78C6C;">3</span></span>\n<span class="line"><span style="color:#A6ACCD;"> dropped:</span><span style="color:#F78C6C;">0</span></span>\n<span class="line"><span style="color:#A6ACCD;"> delivered:</span><span style="color:#F78C6C;">3</span></span>\n<span class="line"><span style="color:#A6ACCD;"> failed:</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> }</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> |</span></span>\n<span class="line"><span style="color:#F78C6C;">SELECT</span></span>\n<span class="line"><span style="color:#A6ACCD;">  map_concat(</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">cast</span><span style="color:#A6ACCD;"> (</span></span>\n<span class="line"><span style="color:#A6ACCD;">      json_parse(etl_context) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> map(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">)</span></span>\n<span class="line"><span style="color:#A6ACCD;">    ),</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">cast</span><span style="color:#A6ACCD;"> (json_parse(progress) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> map(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">))</span></span>\n<span class="line"><span style="color:#A6ACCD;">  )</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4188188261/p297065.png" alt="map_concat"></p></li></ul><h2 id="map-filter\u51FD\u6570" tabindex="-1">map_filter\u51FD\u6570 <a class="header-anchor" href="#map-filter\u51FD\u6570" aria-hidden="true">#</a></h2><p>map_filter\u51FD\u6570\u548CLambda\u8868\u8FBE\u5F0F\u7ED3\u5408\uFF0C\u7528\u4E8E\u8FC7\u6EE4Map\u4E2D\u7684\u5143\u7D20\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map_filter(x, lambda_expression)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr><tr><td><em>lambda_expression_expression</em></td><td>Lambda\u8868\u8FBE\u5F0F\u3002\u66F4\u591A\u4FE1\u606F\uFF0C\u8BF7\u53C2\u89C1<a href="./t13128.html#reference-zwt-jmq-zdb">Lambda\u8868\u8FBE\u5F0F</a>\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><p>\u5C06\u4E24\u4E2A\u6570\u7EC4\u6620\u5C04\u4E3A\u4E00\u4E2A\u65B0\u7684Map\uFF0C\u4E14Map\u4E2D\u7684\u952E\u503C\u4E0D\u4E3Anull\u3002\u5176\u4E2D<code>(k, v) -&gt; v is not null</code>\u4E3ALambda\u8868\u8FBE\u5F0F\u3002</p><ul><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map_filter(map(array[10, 20, 30], array[&#39;a&#39;, NULL, &#39;c&#39;]), (k, v) </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> v </span><span style="color:#F78C6C;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">)</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4188188261/p303830.png" alt="map_filter"></p></li></ul><h2 id="map-keys\u51FD\u6570" tabindex="-1">map_keys\u51FD\u6570 <a class="header-anchor" href="#map-keys\u51FD\u6570" aria-hidden="true">#</a></h2><p>map_keys\u51FD\u6570\u7528\u4E8E\u63D0\u53D6Map\u4E2D\u6240\u6709\u7684\u952E\uFF0C\u5E76\u4EE5\u6570\u7EC4\u5F62\u5F0F\u8FD4\u56DE\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map_keys(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr></tbody></table><p>array\u7C7B\u578B\u3002</p><p>\u65E5\u5FD7\u670D\u52A1\u6570\u636E\u52A0\u5DE5\u65E5\u5FD7\u4E2Detl_context\u5B57\u6BB5\u503C\u4E3Amap\u7C7B\u578B\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528map_keys\u51FD\u6570\u63D0\u53D6etl_context\u5B57\u6BB5\u503C\u4E2D\u6240\u6709\u7684\u952E\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">etl_context: {</span></span>\n<span class="line"><span style="color:#A6ACCD;">project:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">datalab-148****6461-cn-chengdu</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">logstore:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal-etl-log</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer_group:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-83****4d1965</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-b2d40ed****c8d6-291294</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">shard_id:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> }</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map_keys(</span><span style="color:#82AAFF;">try_cast</span><span style="color:#A6ACCD;">(json_parse(etl_context) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> map(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">)))</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1652678261/p303746.png" alt="map_keys"></p></li></ul><h2 id="map-values\u51FD\u6570" tabindex="-1">map_values\u51FD\u6570 <a class="header-anchor" href="#map-values\u51FD\u6570" aria-hidden="true">#</a></h2><p>map_values\u51FD\u6570\u7528\u4E8E\u63D0\u53D6Map\u4E2D\u6240\u6709\u952E\u7684\u503C\uFF0C\u5E76\u4EE5\u6570\u7EC4\u5F62\u5F0F\u8FD4\u56DE\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">map_values(x)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3Amap\u7C7B\u578B\u3002</td></tr></tbody></table><p>array\u7C7B\u578B\u3002</p><p>\u65E5\u5FD7\u670D\u52A1\u6570\u636E\u52A0\u5DE5\u65E5\u5FD7\u4E2Detl_context\u5B57\u6BB5\u503C\u4E3Amap\u7C7B\u578B\uFF0C\u60A8\u53EF\u4EE5\u4F7F\u7528map_values\u51FD\u6570\u63D0\u53D6etl_context\u5B57\u6BB5\u503C\u4E2D\u6240\u6709\u952E\u7684\u503C\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">etl_context: {</span></span>\n<span class="line"><span style="color:#A6ACCD;">project:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">datalab-148****6461-cn-chengdu</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">logstore:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal-etl-log</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer_group:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-83****4d1965</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">consumer:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">etl-b2d40ed****c8d6-291294</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#A6ACCD;">shard_id:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> }</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> map_values(</span><span style="color:#82AAFF;">try_cast</span><span style="color:#A6ACCD;">(json_parse(etl_context) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> map(</span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">)))</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1652678261/p303314.png" alt="map_values"></p></li></ul><h2 id="multimap-agg\u51FD\u6570" tabindex="-1">multimap_agg\u51FD\u6570 <a class="header-anchor" href="#multimap-agg\u51FD\u6570" aria-hidden="true">#</a></h2><p>multimap_agg\u51FD\u6570\u7528\u4E8E\u5C06 <em>x</em> \u548C <em>y</em> \u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002 <em>x</em> \u4E3AMap\u4E2D\u7684\u952E\uFF0C <em>y</em> \u4E3AMap\u4E2D\u7684\u952E\u503C\uFF0C\u952E\u503C\u4E3A\u6570\u7EC4\u683C\u5F0F\u3002\u5F53 <em>y</em> \u5B58\u5728\u591A\u4E2A\u503C\u65F6\uFF0C\u63D0\u53D6\u6240\u6709\u7684\u503C\u4F5C\u4E3A\u952E\u503C\u3002</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">multimap_agg(x, y)</span></span>\n<span class="line"></span></code></pre></div><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><em>x</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr><tr><td><em>y</em></td><td>\u53C2\u6570\u503C\u4E3A\u4EFB\u610F\u6570\u636E\u7C7B\u578B\u3002</td></tr></tbody></table><p>map\u7C7B\u578B\u3002</p><p>\u63D0\u53D6request_method\u5B57\u6BB5\u548Crequest_time\u5B57\u6BB5\u7684\u6240\u6709\u503C\uFF0C\u7136\u540E\u6620\u5C04\u4E3A\u4E00\u4E2AMap\u3002request_method\u5B57\u6BB5\u503C\u4E3AMap\u4E2D\u7684\u952E\uFF0Crequest_time\u5B57\u6BB5\u503C\u4E3AMap\u4E2D\u7684\u952E\u503C\uFF0C\u952E\u503C\u4E3A\u6570\u7EC4\u683C\u5F0F\u3002</p><ul><li><p>\u5B57\u6BB5\u6837\u4F8B</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">request_method:POST</span></span>\n<span class="line"><span style="color:#A6ACCD;">request_time:</span><span style="color:#F78C6C;">80</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u8BED\u53E5</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> multimap_agg(request_method,request_time)</span></span>\n<span class="line"></span></code></pre></div></li><li><p>\u67E5\u8BE2\u548C\u5206\u6790\u7ED3\u679C</p><p><img src="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4951288261/p242228.png" alt="multimap_agg"></p></li></ul>', 90);
const _hoisted_91 = [
  _hoisted_1
];
function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
  return openBlock(), createElementBlock("div", null, _hoisted_91);
}
const _8Map________ = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render]]);
export {
  __pageData,
  _8Map________ as default
};
